import{r as n,j as e,s as a}from"./index-CwyAPZOZ.js";const p={company:"",role:"",start_date:"",end_date:null,description:"",technologies:[],type:"work",sort_order:0};function S(){const[h,j]=n.useState([]),[o,d]=n.useState(null),[v,c]=n.useState(!1),[r,s]=n.useState(p),[x,i]=n.useState(""),[g,y]=n.useState(!1);async function m(){if(!a)return;const{data:t}=await a.from("experiences").select("*").order("sort_order");t&&j(t)}n.useEffect(()=>{m()},[]);function N(t){d(t),s({company:t.company,role:t.role,start_date:t.start_date,end_date:t.end_date,description:t.description,technologies:t.technologies,type:t.type,sort_order:t.sort_order}),i(t.technologies.join(", ")),c(!0)}function _(){d(null),s({...p,sort_order:0}),i(""),c(!0)}function f(){d(null),s(p),i(""),c(!1)}async function k(t){if(t.preventDefault(),!a)return;y(!0);const u={...r,technologies:x.split(",").map(l=>l.trim()).filter(Boolean)};if(o)await a.from("experiences").update(u).eq("id",o.id);else{const{data:l}=await a.from("experiences").select("id, sort_order").gte("sort_order",u.sort_order).order("sort_order",{ascending:!1});if(l)for(const b of l)await a.from("experiences").update({sort_order:b.sort_order+1}).eq("id",b.id);await a.from("experiences").insert(u)}y(!1),f(),m()}async function C(t){!a||!confirm("Delete this experience?")||(await a.from("experiences").delete().eq("id",t),m())}return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Experiences"}),e.jsx("button",{onClick:_,className:"rounded-lg bg-primary-500 px-3 py-1.5 text-sm font-medium text-white hover:bg-primary-600",children:"+ Add"})]}),e.jsx("div",{className:"space-y-3",children:h.map(t=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-gray-200 bg-white px-4 py-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t.role}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.company," · ",t.start_date,t.end_date?` – ${t.end_date}`:""," · ",t.type]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>N(t),className:"rounded px-2 py-1 text-xs text-primary-600 hover:bg-primary-50",children:"Edit"}),e.jsx("button",{onClick:()=>C(t.id),className:"rounded px-2 py-1 text-xs text-red-600 hover:bg-red-50",children:"Delete"})]})]},t.id))}),v&&e.jsxs("form",{onSubmit:k,className:"mt-6 space-y-4 rounded-xl border border-gray-200 bg-white p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:o?"Edit Experience":"New Experience"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Company"}),e.jsx("input",{required:!0,value:r.company,onChange:t=>s({...r,company:t.target.value}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm outline-none focus:border-primary-300 focus:ring-2 focus:ring-primary-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Role"}),e.jsx("input",{required:!0,value:r.role,onChange:t=>s({...r,role:t.target.value}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm outline-none focus:border-primary-300 focus:ring-2 focus:ring-primary-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Start Date"}),e.jsx("input",{required:!0,placeholder:"Jan 2024",value:r.start_date,onChange:t=>s({...r,start_date:t.target.value}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm outline-none focus:border-primary-300 focus:ring-2 focus:ring-primary-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"End Date"}),e.jsx("input",{placeholder:"Present (leave blank)",value:r.end_date??"",onChange:t=>s({...r,end_date:t.target.value||null}),className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm outline-none focus:border-primary-300 focus:ring-2 focus:ring-primary-100"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Description"}),e.jsx("textarea",{value:r.description,onChange:t=>s({...r,description:t.target.value}),rows:3,className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm outline-none focus:border-primary-300 focus:ring-2 focus:ring-primary-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Technologies (comma-separated)"}),e.jsx("input",{value:x,onChange:t=>i(t.target.value),placeholder:"React, TypeScript, Node.js",className:"w-full rounded-lg border border-gray-200 px-3 py-2 text-sm outline-none focus:border-primary-300 focus:ring-2 focus:ring-primary-100"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx("input",{type:"radio",name:"type",value:"work",checked:r.type==="work",onChange:()=>s({...r,type:"work"})}),"Work"]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx("input",{type:"radio",name:"type",value:"education",checked:r.type==="education",onChange:()=>s({...r,type:"education"})}),"Education"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Sort Order"}),e.jsx("input",{type:"number",value:r.sort_order,onChange:t=>s({...r,sort_order:Number(t.target.value)}),className:"w-24 rounded-lg border border-gray-200 px-3 py-2 text-sm outline-none focus:border-primary-300 focus:ring-2 focus:ring-primary-100"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:g,className:"rounded-lg bg-primary-500 px-4 py-2 text-sm font-medium text-white hover:bg-primary-600 disabled:opacity-50",children:g?"Saving...":o?"Update":"Create"}),e.jsx("button",{type:"button",onClick:f,className:"rounded-lg px-4 py-2 text-sm text-gray-600 hover:bg-gray-100",children:"Cancel"})]})]})]})}export{S as default};
